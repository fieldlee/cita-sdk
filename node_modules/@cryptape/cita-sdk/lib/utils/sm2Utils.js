"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const lib_1 = require("@cryptape/cita-signer/lib");
exports.privateKeyToPublicKeyBySM2 = (privateKey) => {
    const key = privateKey.replace(/^0x/, '');
    return lib_1.sm2.SM2KeyPair(null, key).pubToString();
};
exports.publicKeyToAddressSM2 = (publicKey) => {
    return `0x${lib_1.bytes2hex(lib_1.sm3().sum(lib_1.hex2bytes(publicKey.slice(2))))
        .slice(-40)
        .toLowerCase()}`;
};
function accountSignedBySm2(account) {
    const pubKey = exports.privateKeyToPublicKeyBySM2(account.privateKey);
    account.address = exports.publicKeyToAddressSM2(pubKey);
    return account;
}
exports.accountSignedBySm2 = accountSignedBySm2;
